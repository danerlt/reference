<!doctype html>
<html lang="en" data-color-mode="dark">
<head>
<meta charset="utf-8">
<title>---
title: Sed
date: 2020-12-27 18:34:08
icon: icon-sed
background: bg-red-400
tags:
    - editor
    - replace
    - text
    - utility
categories:
    - Linux Command
intro: |
    [Sed](https://www.gnu.org/software/sed/manual/sed.html) is a stream editor, this sed cheat sheet contains sed commands and some common sed tricks.
---

Getting started {.cols-3}
---------------

### Sed Usage

Syntax
```shell script
$ sed [options] command [input-file]
```

With pipeline
```shell script
$ cat report.txt | sed 's/Nick/John/g'
```

```shell script
$ echo '123abc' | sed 's/[0-9]+//g'
```

### Option Examples {.col-span-2}

| Option | Example                                    | Description                             |
|--------|--------------------------------------------|-----------------------------------------|
| `-i`   | sed -ibak 's/On/Off/' php.ini              | Backup and modify input file directly   |
| `-E`   | sed -E 's/[0-9]+//g' input-file            | Use extended regular expressions        |
| `-n`   | sed -n '3 p' config.conf                   | Suppress default pattern space printing |
| `-f`   | sed -f script.sed config.conf              | Execute sed script file                 |
| `-e`   | sed -e 'command1' -e 'command2' input-file | Execute multiple sed commands           |
{.show-header}


### Multiple commands
```shell script {.wrap}
$ echo "hello world" | sed -e 's/h/H/g' -e 's/w/W/g'
Hello World
```
Use `-e` to execute multiple sed commands



### Sed script
```shell script
$ echo 's/h/H/g' >> hello.sed
$ echo 's/w/W/g' >> hello.sed
$ echo "hello world" | sed -f hello.sed
Hello World
```
Use `-f` to execute sed script file



### Examples

```shell script
$ sed 's/old/new/g' file.txt
$ sed 's/old/new/g' file.txt > new.txt

$ sed 's/old/new/g' -i file.txt
$ sed 's/old/new/g' -i.backup file.txt
```

See: [Sed examples](#sed-examples)



Sed commands {.cols-3}
-----------

### Commands {.col-span-2}

| Command | Example                                | Description                 |
|---------|----------------------------------------|-----------------------------|
| `p`     | sed -n '1,4 p' input.txt               | Print lines 1-4             |
| `p`     | sed -n -e '1,4 p' -e '6,7 p' input.txt | Print lines 1-4 and 6-7     |
| `d`     | sed '1,4 d' input.txt                  | Print lines except 1-4      |
| `w`     | sed -n '1,4 w output.txt' input.txt    | Write pattern space to file |
| `a`     | sed '2 a new-line' input.txt           | Append line after           |
| `i`     | sed '2 i new-line' input.txt           | Insert line before          |
{.show-header}



### Space commands

| Command | Description                                                  |
|---------|--------------------------------------------------------------|
| `n`     | Print pattern space, empty pattern space, and read next line |
| `x`     | Swap pattern space with hold space                           |
| `h`     | Copy pattern space to hold space                             |
| `H`     | Append pattern space to hold space                           |
| `g`     | Copy hold space to pattern space                             |
| `G`     | Append hold space to pattern space                           |

See also: [File spacing](#file-spacing)



### Flags

```shell script
$ sed 's/old/new/[flags]' [input-file]
```
---
 
| Flag     | Description                                |
|----------|--------------------------------------------|
| `g`      | Global substitution                        |
| `1,2...` | Substitute the nth occurrence              |
| `p`      | Print only the substituted line            |
| `w`      | Write only the substituted line to a file  |
| `I`      | Ignore case while searching                |
| `e`      | Substitute and execute in the command line |


### Loops commands

| Command   | Description                                                        |
|-----------|--------------------------------------------------------------------|
| `b label` | Branch to a label (for looping)                                    |
| `t label` | Branch to a label only on successful substitution&#x3C;br>(for looping) |
| `:label`  | Label for the b and t commands (for looping)                       |
| `N`       | Append next line to pattern space                                  |
| `P`       | Print 1st line in multi-line                                       |
| `D`       | Delete 1st line in multi-line                                      |



### Misc Flags
| Flag           | Description                                                                  |
|----------------|------------------------------------------------------------------------------|
| `/ | ^ @ ! #`  | Substitution delimiter can be any character                                  |
| `&#x26;`            | Gets the matched pattern                                                     |
| `( ) \1 \2 \3` | Group using `(` and `)`.&#x3C;br>Use `\1`, `\2` in replacement to refer the group |




Sed examples {.cols-3}
----------



### Replacing text {.row-span-2}

Replace all occurrences of a string
```shell script
$ sed 's/old/new/g' file.txt
```
Replace only the nth occurrence of a string
```shell script
$ sed 's/old/new/2' file.txt
```
Replace replace a string only on the 5th line
```shell script
$ sed '5 s/old/new/' file.txt
```
Replace "world" with "universe" but only if the line begins with "hello"
```shell script
$ sed '/hello/s/world/universe/' file.txt
```
Remove "\" from the end of each line
```shell script
$ sed 's/\\$//' file.txt
```
Remove all whitespace from beginning of each line
```shell script
$ sed 's/^\s*//' file.txt
```
Remove comments. Even those that are at the end of a line
```shell script
$ sed 's/#.*$//' file.txt
```


### Search for text

Search for a string and only print the lines that were matched
```shell script
$ sed -n '/hello/p' file.txt
```
Case insensitive search
```shell script
$ sed -n '/hello/Ip' file.txt
```
Search for a string but only output lines that do not match
```shell script
$ sed -n '/hello/!p' file.txt
```



### Appending lines

Append line after line 2
```shell script
$ sed '2a Text after line 2' file.txt
```
Append line at the end of the file
```shell script
$ sed '$a THE END!' file.txt
```
Append line after every 3rd line starting from line 3
```shell script
$ sed '3~3a Some text' file.txt
```



### Numbering {.col-span-2}

Number line of a file (simple left alignment)
```shell script
$ sed  &#x26;  sed cheatsheet &#x26;  Quick Reference</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta description="为开发人员分享快速参考备忘单。">
<meta keywords="Quick,Reference,cheatsheet,sed">
<link rel="stylesheet" href="style/style.css">
</head>
<body><nav class="header-nav"><div class="max-container"><a href="index.html" class="logo"><svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" height="1em" width="1em"><path opacity=".5" d="m21.66 10.44-.98 4.18c-.84 3.61-2.5 5.07-5.62 4.77-.5-.04-1.04-.13-1.62-.27l-1.68-.4c-4.17-.99-5.46-3.05-4.48-7.23l.98-4.19c.2-.85.44-1.59.74-2.2 1.17-2.42 3.16-3.07 6.5-2.28l1.67.39c4.19.98 5.47 3.05 4.49 7.23Z" fill="white"></path><path d="M15.06 19.39c-.62.42-1.4.77-2.35 1.08l-1.58.52c-3.97 1.28-6.06.21-7.35-3.76L2.5 13.28c-1.28-3.97-.22-6.07 3.75-7.35l1.58-.52c.41-.13.8-.24 1.17-.31-.3.61-.54 1.35-.74 2.2l-.98 4.19c-.98 4.18.31 6.24 4.48 7.23l1.68.4c.58.14 1.12.23 1.62.27Zm2.43-8.88c-.06 0-.12-.01-.19-.02l-4.85-1.23a.75.75 0 0 1 .37-1.45l4.85 1.23a.748.748 0 0 1-.18 1.47Z" fill="#cbd5e1"></path><path d="M14.56 13.89c-.06 0-.12-.01-.19-.02l-2.91-.74a.75.75 0 0 1 .37-1.45l2.91.74c.4.1.64.51.54.91-.08.34-.38.56-.72.56Z" fill="#292D32"></path></svg><span class="title">Quick Reference</span></a><div class="menu"><a href="https://github.com/danerlt/reference/blob/main/sed.md" class="" target="__blank"><svg viewBox="0 0 36 36" fill="currentColor" height="1em" width="1em"><path d="m33 6.4-3.7-3.7a1.71 1.71 0 0 0-2.36 0L23.65 6H6a2 2 0 0 0-2 2v22a2 2 0 0 0 2 2h22a2 2 0 0 0 2-2V11.76l3-3a1.67 1.67 0 0 0 0-2.36ZM18.83 20.13l-4.19.93 1-4.15 9.55-9.57 3.23 3.23ZM29.5 9.43 26.27 6.2l1.85-1.85 3.23 3.23Z"></path><path fill="none" d="M0 0h36v36H0z"></path></svg><span>编辑</span></a><a href="https://github.com/jaywcjlove/reference" class="" target="__blank"><svg viewBox="0 0 16 16" fill="currentColor" height="1em" width="1em"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg></a></div></div></nav><div class="wrap"><div class="wrap-header h2wrap"><h2>
  title: Sed
  date: 2020-12-27 18:34:08
  icon: icon-sed
  background: bg-red-400
  tags:
  - editor
  - replace
  - text
  - utility
  categories:
  - Linux Command
  intro: |
  <a href="https://www.gnu.org/software/sed/manual/sed.html">Sed</a> is a stream editor, this sed cheat sheet contains sed commands and some common sed tricks.
</h2><div class="wrap-body">
</div></div></div><div class="wrap"><div class="wrap-header h2wrap"><h2>Getting started {.cols-3}</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap"><div class="wrap-header h3wrap"><h3>Sed Usage</h3><div class="wrap-body">
<p>Syntax</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token builtin class-name">command</span> <span class="token punctuation">[</span>input-file<span class="token punctuation">]</span>
</span></code></pre>
<p>With pipeline</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">cat</span> report.txt <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/Nick/John/g'</span>
</span></code></pre>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token builtin class-name">echo</span> <span class="token string">'123abc'</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'s/[0-9]+//g'</span>
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Option Examples {.col-span-2}</h3><div class="wrap-body">
<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Example</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>-i</code></td>
      <td>sed -ibak 's/On/Off/' php.ini</td>
      <td>Backup and modify input file directly</td>
    </tr>
    <tr>
      <td><code>-E</code></td>
      <td>sed -E 's/[0-9]+//g' input-file</td>
      <td>Use extended regular expressions</td>
    </tr>
    <tr>
      <td><code>-n</code></td>
      <td>sed -n '3 p' config.conf</td>
      <td>Suppress default pattern space printing</td>
    </tr>
    <tr>
      <td><code>-f</code></td>
      <td>sed -f script.sed config.conf</td>
      <td>Execute sed script file</td>
    </tr>
    <tr>
      <td><code>-e</code></td>
      <td>sed -e 'command1' -e 'command2' input-file</td>
      <td>Execute multiple sed commands</td>
    </tr>
    <tr>
      <td>{.show-header}</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Multiple commands</h3><div class="wrap-body">
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token builtin class-name">echo</span> <span class="token string">"hello world"</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-e</span> <span class="token string">'s/h/H/g'</span> <span class="token parameter variable">-e</span> <span class="token string">'s/w/W/g'</span>
</span><span class="code-line line-number" line="2">Hello World
</span></code></pre>
<p>Use <code>-e</code> to execute multiple sed commands</p>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Sed script</h3><div class="wrap-body">
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token builtin class-name">echo</span> <span class="token string">'s/h/H/g'</span> <span class="token operator">>></span> hello.sed
</span><span class="code-line line-number" line="2">$ <span class="token builtin class-name">echo</span> <span class="token string">'s/w/W/g'</span> <span class="token operator">>></span> hello.sed
</span><span class="code-line line-number" line="3">$ <span class="token builtin class-name">echo</span> <span class="token string">"hello world"</span> <span class="token operator">|</span> <span class="token function">sed</span> <span class="token parameter variable">-f</span> hello.sed
</span><span class="code-line line-number" line="4">Hello World
</span></code></pre>
<p>Use <code>-f</code> to execute sed script file</p>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Examples</h3><div class="wrap-body">
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/old/new/g'</span> file.txt
</span><span class="code-line line-number" line="2">$ <span class="token function">sed</span> <span class="token string">'s/old/new/g'</span> file.txt <span class="token operator">></span> new.txt
</span><span class="code-line line-number" line="3">
</span><span class="code-line line-number" line="4">$ <span class="token function">sed</span> <span class="token string">'s/old/new/g'</span> <span class="token parameter variable">-i</span> file.txt
</span><span class="code-line line-number" line="5">$ <span class="token function">sed</span> <span class="token string">'s/old/new/g'</span> <span class="token parameter variable">-i.backup</span> file.txt
</span></code></pre>
<p>See: <a href="#sed-examples">Sed examples</a></p>
</div></div></div></div></div><div class="wrap"><div class="wrap-header h2wrap"><h2>Sed commands {.cols-3}</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap"><div class="wrap-header h3wrap"><h3>Commands {.col-span-2}</h3><div class="wrap-body">
<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Example</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>p</code></td>
      <td>sed -n '1,4 p' input.txt</td>
      <td>Print lines 1-4</td>
    </tr>
    <tr>
      <td><code>p</code></td>
      <td>sed -n -e '1,4 p' -e '6,7 p' input.txt</td>
      <td>Print lines 1-4 and 6-7</td>
    </tr>
    <tr>
      <td><code>d</code></td>
      <td>sed '1,4 d' input.txt</td>
      <td>Print lines except 1-4</td>
    </tr>
    <tr>
      <td><code>w</code></td>
      <td>sed -n '1,4 w output.txt' input.txt</td>
      <td>Write pattern space to file</td>
    </tr>
    <tr>
      <td><code>a</code></td>
      <td>sed '2 a new-line' input.txt</td>
      <td>Append line after</td>
    </tr>
    <tr>
      <td><code>i</code></td>
      <td>sed '2 i new-line' input.txt</td>
      <td>Insert line before</td>
    </tr>
    <tr>
      <td>{.show-header}</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Space commands</h3><div class="wrap-body">
<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>n</code></td>
      <td>Print pattern space, empty pattern space, and read next line</td>
    </tr>
    <tr>
      <td><code>x</code></td>
      <td>Swap pattern space with hold space</td>
    </tr>
    <tr>
      <td><code>h</code></td>
      <td>Copy pattern space to hold space</td>
    </tr>
    <tr>
      <td><code>H</code></td>
      <td>Append pattern space to hold space</td>
    </tr>
    <tr>
      <td><code>g</code></td>
      <td>Copy hold space to pattern space</td>
    </tr>
    <tr>
      <td><code>G</code></td>
      <td>Append hold space to pattern space</td>
    </tr>
  </tbody>
</table>
<p>See also: <a href="#file-spacing">File spacing</a></p>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Flags</h3><div class="wrap-body">
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/old/new/[flags]'</span> <span class="token punctuation">[</span>input-file<span class="token punctuation">]</span>
</span></code></pre>
<hr>
<table>
  <thead>
    <tr>
      <th>Flag</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>g</code></td>
      <td>Global substitution</td>
    </tr>
    <tr>
      <td><code>1,2...</code></td>
      <td>Substitute the nth occurrence</td>
    </tr>
    <tr>
      <td><code>p</code></td>
      <td>Print only the substituted line</td>
    </tr>
    <tr>
      <td><code>w</code></td>
      <td>Write only the substituted line to a file</td>
    </tr>
    <tr>
      <td><code>I</code></td>
      <td>Ignore case while searching</td>
    </tr>
    <tr>
      <td><code>e</code></td>
      <td>Substitute and execute in the command line</td>
    </tr>
  </tbody>
</table>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Loops commands</h3><div class="wrap-body">
<table>
  <thead>
    <tr>
      <th>Command</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>b label</code></td>
      <td>Branch to a label (for looping)</td>
    </tr>
    <tr>
      <td><code>t label</code></td>
      <td>Branch to a label only on successful substitution<br>(for looping)</td>
    </tr>
    <tr>
      <td><code>:label</code></td>
      <td>Label for the b and t commands (for looping)</td>
    </tr>
    <tr>
      <td><code>N</code></td>
      <td>Append next line to pattern space</td>
    </tr>
    <tr>
      <td><code>P</code></td>
      <td>Print 1st line in multi-line</td>
    </tr>
    <tr>
      <td><code>D</code></td>
      <td>Delete 1st line in multi-line</td>
    </tr>
  </tbody>
</table>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Misc Flags</h3><div class="wrap-body">
<table>
  <thead>
    <tr>
      <th>Flag</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>`/</td>
      <td>^ @ ! #`</td>
    </tr>
    <tr>
      <td><code>&#x26;</code></td>
      <td>Gets the matched pattern</td>
    </tr>
    <tr>
      <td><code>( ) \1 \2 \3</code></td>
      <td>Group using <code>(</code> and <code>)</code>.<br>Use <code>\1</code>, <code>\2</code> in replacement to refer the group</td>
    </tr>
  </tbody>
</table>
</div></div></div></div></div><div class="wrap"><div class="wrap-header h2wrap"><h2>Sed examples {.cols-3}</h2><div class="wrap-body">
</div></div><div class="h2wrap-body"><div class="wrap"><div class="wrap-header h3wrap"><h3>Replacing text {.row-span-2}</h3><div class="wrap-body">
<p>Replace all occurrences of a string</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/old/new/g'</span> file.txt
</span></code></pre>
<p>Replace only the nth occurrence of a string</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/old/new/2'</span> file.txt
</span></code></pre>
<p>Replace replace a string only on the 5th line</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'5 s/old/new/'</span> file.txt
</span></code></pre>
<p>Replace "world" with "universe" but only if the line begins with "hello"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/hello/s/world/universe/'</span> file.txt
</span></code></pre>
<p>Remove "" from the end of each line</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/\\$//'</span> file.txt
</span></code></pre>
<p>Remove all whitespace from beginning of each line</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/^\s*//'</span> file.txt
</span></code></pre>
<p>Remove comments. Even those that are at the end of a line</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'s/#.*$//'</span> file.txt
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Search for text</h3><div class="wrap-body">
<p>Search for a string and only print the lines that were matched</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">'/hello/p'</span> file.txt
</span></code></pre>
<p>Case insensitive search</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">'/hello/Ip'</span> file.txt
</span></code></pre>
<p>Search for a string but only output lines that do not match</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">'/hello/!p'</span> file.txt
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Appending lines</h3><div class="wrap-body">
<p>Append line after line 2</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'2a Text after line 2'</span> file.txt
</span></code></pre>
<p>Append line at the end of the file</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'$a THE END!'</span> file.txt
</span></code></pre>
<p>Append line after every 3rd line starting from line 3</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'3~3a Some text'</span> file.txt
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Numbering {.col-span-2}</h3><div class="wrap-body">
<p>Number line of a file (simple left alignment)</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token operator">=</span> file.txt <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'N;s/\n/\t/'</span>
</span></code></pre>
<p>Number line of a file (number on left, right-aligned)</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token operator">=</span> file.txt <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'N; s/^/   /; s/ *\(.\{6,\}\)\n/\1  /'</span>
</span></code></pre>
<p>Number line of file, but only print numbers if line is not blank</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/./='</span> file.txt <span class="token operator">|</span> <span class="token function">sed</span> <span class="token string">'/./N; s/\n/ /'</span>
</span></code></pre>
<p>Count lines (emulates "wc -l")</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token parameter variable">-n</span> <span class="token string">'$='</span>
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Prepending lines</h3><div class="wrap-body">
<p>Insert text before line 5</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'5i line number five'</span> file.txt
</span></code></pre>
<p>Insert "Example: " before each line that contains "hello"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/hello/i Example: '</span> file.txt
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>Deleting lines</h3><div class="wrap-body">
<p>Delete line 5-7 in file</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'5,7d'</span> file.txt
</span></code></pre>
<p>Delete every 2nd line starting with line 3</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'3~2d'</span> file.txt
</span></code></pre>
<p>Delete the last line in file</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'$d'</span> file.txt
</span></code></pre>
<p>Delete lines starting with "Hello"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/^Hello/d'</span> file.txt
</span></code></pre>
<p>Delete all empty lines</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/^$/d'</span> file.txt
</span></code></pre>
<p>Delete lines starting with "#"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/^#/d'</span> file.txt
</span></code></pre>
</div></div></div><div class="wrap"><div class="wrap-header h3wrap"><h3>File spacing</h3><div class="wrap-body">
<p>Double space</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> G
</span></code></pre>
<p>Delete all blank lines and double space</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/^$/d;G'</span>
</span></code></pre>
<p>Triple space a file</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'G;G'</span>
</span></code></pre>
<p>Undo double-spacing</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'n;d'</span>
</span></code></pre>
<p>Insert a blank line above line which matches "regex"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/regex/{x;p;x;}'</span>
</span></code></pre>
<p>Insert a blank line below line which matches "regex"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/regex/G'</span>
</span></code></pre>
<p>Insert a blank line around line which matches "regex"</p>
<pre class="language-shell"><code class="language-shell code-highlight"><span class="code-line line-number" line="1">$ <span class="token function">sed</span> <span class="token string">'/regex/{x;p;x;G;}'</span>
</span></code></pre>
</div></div></div></div></div><div class="wrap"><div class="wrap-header h2wrap"><h2>Also see {.cols-1}</h2><div class="wrap-body">
<ul>
  <li><a href="https://gist.github.com/ssstonebraker/6140154">sed cheatsheet</a> <em>(gist.github.com)</em></li>
</ul>

</div></div></div><footer class="footer-wrap"><footer class="max-container">© 2022 Kenny Wang, All rights reserved.</footer></footer></body>
</html>
